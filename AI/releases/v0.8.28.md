# TestMe v0.8.28 Release Notes

Released: October 31, 2025

## Enhancements

### Test Error Reporting

**Global Installation Path Handling:**
- Fixed stack trace detection when TestMe is installed globally via npm/bun
- Now correctly identifies test file locations on Windows, macOS, and Linux
- Handles various installation paths: node_modules/@embedthis/testme, .bun/install/global, etc.
- Added fallback logic in test() error handler to extract location from error stack when primary detection fails
- Eliminates "unknown file:unknown line" errors in globally-installed TestMe

## Implementation Details

### Stack Trace Changes

Enhanced `getStack()` logic in `src/modules/js/index.js`:
- Added Windows-style path separators (backslash) to path filters
- Now filters out multiple installation path patterns:
  - `testme/src/modules/` and `testme\src\modules\` (forward and backslash)
  - `node_modules/@embedthis/testme` and `node_modules\@embedthis\testme`
  - `.bun/install/global/node_modules/@embedthis/testme`
- Handles both Unix-style and Windows-style paths

Enhanced error handling in `test()` function:
- Added fallback stack parsing when error message contains "unknown file:unknown line"
- Extracts actual test file location from error.stack when primary detection fails
- Replaces "unknown file:unknown line" with actual file:line from stack trace
- Provides accurate location reporting even when global installation paths interfere
- Uses same path filtering logic as getStack() for consistency

## Files Changed

- [package.json](../../package.json) - Version bump to 0.8.28
- [src/version.ts](../../src/version.ts) - Version bump to 0.8.28
- [src/modules/js/index.js](../../src/modules/js/index.js) - Enhanced stack trace handling for global installations

## Upgrade Notes

This is a bug fix release that improves error reporting when TestMe is installed globally. The changes are fully backward compatible and require no configuration updates.

Users upgrading from v0.8.27 will experience:
- Accurate file:line locations in error messages on all platforms
- Better error reporting when using globally-installed TestMe
- Consistent error location reporting across development and CI environments
- No changes to test execution behavior or configuration format

## Previous Release

See [v0.8.27 Release Notes](v0.8.27.md) for information about the previous release which included:
- Health check improvements with setup process exit detection
- Improved stack trace capture with best candidate approach
- Better handling of complex stack traces
